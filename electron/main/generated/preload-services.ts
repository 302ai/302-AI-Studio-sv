import { ipcRenderer } from "electron";
import type {
	StorageValue,
	StorageOptions,
	StorageMetadata,
	StorageMeta,
	StorageItem,
	Theme,
	Platform,
} from "@shared/types";

/**
 * Auto-generated IPC service interfaces
 */
export interface AutoGeneratedIpcServices {
	storageService: {
		setItem(key: string, value: StorageValue | null): Promise<void>;
		getItem<T = StorageValue>(key: string): Promise<T | null>;
		hasItem(key: string): Promise<boolean>;
		removeItem(key: string, options: StorageOptions): Promise<void>;
		getKeys(base: string): Promise<string[]>;
		clear(base: string): Promise<void>;
		getMeta(key: string): Promise<StorageMetadata>;
		setMeta(key: string, metadata: StorageMeta): Promise<void>;
		removeMeta(key: string): Promise<void>;
		getItems(keys: string[]): Promise<StorageItem[]>;
		setItems(items: StorageItem[]): Promise<void>;
		watch(watchKey: string): Promise<void>;
		unwatch(watchKey: string): Promise<void>;
	};
	appService: {
		setTheme(theme: Theme): Promise<void>;
	};
	deviceService: {
		getPlatform(): Promise<Platform>;
	};
}

/**
 * Auto-generated service implementations
 */
export const autoGeneratedServices: AutoGeneratedIpcServices = {
	storageService: {
		setItem: (key: string, value: StorageValue | null) =>
			ipcRenderer.invoke("storageService:setItem", key, value),
		getItem: <T = StorageValue>(key: string) =>
			ipcRenderer.invoke("storageService:getItem", key) as Promise<T | null>,
		hasItem: (key: string) => ipcRenderer.invoke("storageService:hasItem", key),
		removeItem: (key: string, options: StorageOptions) =>
			ipcRenderer.invoke("storageService:removeItem", key, options),
		getKeys: (base: string) => ipcRenderer.invoke("storageService:getKeys", base),
		clear: (base: string) => ipcRenderer.invoke("storageService:clear", base),
		getMeta: (key: string) => ipcRenderer.invoke("storageService:getMeta", key),
		setMeta: (key: string, metadata: StorageMeta) =>
			ipcRenderer.invoke("storageService:setMeta", key, metadata),
		removeMeta: (key: string) => ipcRenderer.invoke("storageService:removeMeta", key),
		getItems: (keys: string[]) => ipcRenderer.invoke("storageService:getItems", keys),
		setItems: (items: StorageItem[]) => ipcRenderer.invoke("storageService:setItems", items),
		watch: (watchKey: string) => ipcRenderer.invoke("storageService:watch", watchKey),
		unwatch: (watchKey: string) => ipcRenderer.invoke("storageService:unwatch", watchKey),
	},
	appService: {
		setTheme: (theme: Theme) => ipcRenderer.invoke("appService:setTheme", theme),
	},
	deviceService: {
		getPlatform: () => ipcRenderer.invoke("deviceService:getPlatform"),
	},
};

/**
 * Export type declaration extensions
 */
export interface ElectronAPIExtension {
	storageService: AutoGeneratedIpcServices["storageService"];
	appService: AutoGeneratedIpcServices["appService"];
	deviceService: AutoGeneratedIpcServices["deviceService"];
}
